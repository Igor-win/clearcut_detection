#server {
#    listen       9000 default_server;
#    server_name  localhost;

#    client_max_body_size 1024m;
#    proxy_ignore_headers X-Accel-Expires Expires;

#    location / {
#        proxy_pass       http://django:9000;
#        proxy_set_header Host      $http_host;
#        proxy_set_header X-Real-IP $remote_addr;
#    }
#}

server {
    listen       80;

    client_max_body_size 1024m;
    proxy_ignore_headers X-Accel-Expires Expires;

    location / {
        #proxy_pass       http://react:3000;
        #proxy_set_header Host      $http_host;
        #proxy_set_header X-Real-IP $remote_addr;
	      root		 /frontend/build;
	      try_files	 $uri /index.html =404;
    }

    location /static {
        expires 7d;
        proxy_pass       http://django:9000;
        gzip on;
        gzip_proxied any;
        gzip_types text/plain text/css application/javascript application/x-javascript text/xml application/xml application/rss+xml text/javascript image/x-icon image/bmp image/svg+xml;
        gzip_vary on;
    }

    location /api {
        proxy_pass       http://django:9000;
        proxy_set_header Host      $http_host;
        proxy_set_header X-Real-IP $remote_addr;
    }
    location /admin {
        proxy_pass       http://django:9000;
        proxy_set_header Host      $http_host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
